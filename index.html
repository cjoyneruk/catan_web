<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test sheet</title>
</head>
<body>

    <div class="output">
        Here is my test sheet
    </div>

    <br>

    <table id="full_table" style="border: 1px solid #000000">
        <thead>
            <tr>
                <td>Game number</td>
                <td>Game type</td>
                <td>Date</td>
                <td>Player</td>
                <td>Points</td>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>

    <script>
    
    async function getSheetData(url){

        try {
            const response = await fetch(url)
            const text_data = await response.text()

            const data = JSON.parse(text_data.substr(47).slice(0, -2))
            
            return data
        } catch (err) {
            console.error(err)
        }
    }

    function createTable(data){

        table = document.getElementById('full_table')
        tbody = table.getElementsByTagName('tbody')[0]

        data.table.rows.forEach(row => {
            console.log('Yes')
            console.log(row.c)
            tr = document.createElement('tr')
            row.c.forEach(el => {
                td = document.createElement('td')
                td.innerHTML = el.v
                tr.appendChild(td)
            })
            tbody.appendChild(tr)
        }) 
        
    }

    async function main(){

        const url = 'https://docs.google.com/spreadsheets/d/13lr1lbVzE-fpeGLy_X80PKPHCEXzpqUe1Yu04Q2sin8/gviz/tq?'

        data = await getSheetData(url)

        createTable(data)

    }

    main()



    </script>

</body>
</html>